@using PearReview.Areas.Courses.Models
@using PearReview.Areas.Courses.Services

@page "/courses/{CourseId}/add-assignment"

@inject IApiService ApiService
@inject NavigationManager NavigationManager

<h1>Add Assignment</h1>

<h2>Add Assignment for Course @CourseId</h2>

<div class="row">
    <div class="col-md-6">
        <form>
            <div class="form-group">
                <label for="title">Title</label>
                <input type="text" class="form-control" id="title" @bind="Assignment.Title">
            </div>
            <div class="form-group">
                <label for="description">Description</label>
                <textarea class="form-control" id="description" rows="3" @bind="Assignment.Description"></textarea>
            </div>
            <div class="form-group">
                <label for="dueDate">Due Date</label>
                <input type="datetime-local" class="form-control" id="dueDate" @bind="Assignment.DueDate">
            </div>
            <button type="submit" class="btn btn-primary" @onclick="AddAssignment">Submit</button>
        </form>
    </div>
</div>

<button @onclick="GoToAssignmentsPage">Back to Assignments</button>

@code {
    [Parameter] public string? CourseId { get; set; }
    private IEnumerable<Assignment>? Assignments;

    private Assignment Assignment = new Assignment();

    private async Task AddAssignment()
    {
        if (CourseId != null)
        {
            await ApiService.AddAssignmentForCourse(CourseId, Assignment);
            GoToAssignmentsPage();
        }
    }


    private void GoToAssignmentsPage()
    {
        NavigationManager.NavigateTo($"/courses/{CourseId}/assignments");
    }
}
